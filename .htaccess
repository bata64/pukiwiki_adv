# Apache .htaccess for PukiWiki
#
# $Id: .htaccess,v 1.14.4 2010/07/13 10:12:00 Logue Exp $
# Copyright (C)
#   2010      PukiPlus! Developer Team
#   2006      PukiWiki Plus! Developers Team
#   2002-2005 PukiWiki Developers Team
#   2001      Originally written by yu-ji
# License: GPL v2 or (at your option) any later version
#
# NOTE: Correct permission of this file 644(or 604)

AddDefaultCharset UTF-8

## Access control by Order/Allow/Deny directives
## needs 'AllowOverride Limit' at httpd.conf

# Prohibit direct access to .htaccess, .htpasswd or others
# (If it's not set by default)
#<FilesMatch "^\.ht">
#	Order allow,deny
#	Deny from all
#</FilesMatch>

# Prohibit direct access
<FilesMatch "\.(ini\.php|lng\.php|txt|gz|tgz|zip)$">
	Order allow,deny
	Deny from all
</FilesMatch>

## Authentication to this directory with basic-auth
## needs 'AllowOverride AuthConfig' at httpd.conf
#AuthType Basic
#AuthName      "Authentication required"
#AuthUserFile  /path/to/.htpasswd
#AuthGroupFile /dev/null
#Require       valid-user

#AuthType Digest
#AuthName "PukiWikiAuth"
#AuthDigestProvider file
#AuthUserFile /path/to/.htdigest
#Require valid-user
#BrowserMatch "MSIE" AuthDigestEnableQueryStringHack=On

## Using zlib.output_compression per directory (via .htaccess)
## needs 'AllowOverride Options' at httpd.conf
##
## NOTE:
##   Define PKWK_ZLIB_LOADABLE_MODULE somewhere if you are using
##   PHP extension as loadable module (especially FreeBSD ports)
##   (See BugTrack/738 for detail)
#php_flag zlib.output_compression On

<IfModule mod_gzip.c>
	mod_gzip_on Yes
	mod_gzip_keep_workfiles Yes
	mod_gzip_minimum_file_size  1024
	mod_gzip_maximum_file_size  0
	mod_gzip_maximum_inmem_size 60000
	mod_gzip_dechunk Yes
	mod_gzip_item_include  mime "application/x-httpd-cgi"
	mod_gzip_item_include  mime "application/x-httpd-php"
	mod_gzip_item_include  mime "application/x-javascript"
	mod_gzip_item_include  mime text/*
	mod_gzip_item_include  mime "httpd/unix-directory"
	mod_gzip_item_include  file "\.shtml$"
	mod_gzip_item_include  file "\.htm$"
	mod_gzip_item_include  file "\.html$"
	mod_gzip_item_include  file "\.php$"
	mod_gzip_item_include  file "\.pl$"
	mod_gzip_item_include  file "\.cgi$"
	mod_gzip_item_include  file "\.css$"
	mod_gzip_item_include  file "\.js$"
	mod_gzip_item_exclude  mime "image/.*"
	mod_gzip_min_http 1001
</IfModule>


## To static URL
##
#AllowEncodedSlashes On
#<IfModule mod_rewrite.c>
#	RewriteEngine on
#	RewriteCond %{REQUEST_FILENAME} !-f
#	RewriteCond %{REQUEST_FILENAME} !-d
#	RewriteRule ^(.+)/$ index.php?$1 [L]
#	RewriteRule ^(.+)\.html$ index.php?$1 [L]
#</IfModule>

# Allow direct access to robots.txt
<FilesMatch "^robots\.txt$">
	Order Deny,Allow
	Allow from all
</FilesMatch>

# Expire Header
<IfModule mod_expires.c>
	ExpiresActive On
	<FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf|gz)$"> # 24weeks
		ExpiresDefault "access plus 1 year"
	</FilesMatch>
</IfModule>